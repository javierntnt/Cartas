<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vite App</title>
  </head>
  <body>
     <h1>Juego de 21 (Blackjack)</h1>

  <h2>Jugador</h2>
  <div id="cartas-jugador" class="cards"></div>
  <p id="puntos-jugador">Puntos: 0</p>

  <h2>Dealer</h2>
  <div id="cartas-dealer" class="cards"></div>
  <p id="puntos-dealer">Puntos: 0</p>

  <div class="btns">
    <button onclick="pedirCarta()">Pedir</button>
    <button onclick="plantarse()">Plantarse</button>
    <button onclick="reiniciar()">Reiniciar</button>
  </div>

  <div id="mensaje"></div>

  <script>
    const cartas = [2, 3, 4, 5, 6, 7, 8, 9, 10, 10, 10, 10, 11]; // 10 = J/Q/K, 11 = A
    let mazo = [];
    let jugador = [];
    let dealer = [];
    let terminado = false;

    function barajar() {
      mazo = [];
      for (let i = 0; i < 4; i++) {
        mazo = mazo.concat(cartas);
      }
      mazo = mazo.sort(() => Math.random() - 0.5);
    }

    function repartirInicial() {
      jugador = [sacarCarta(), sacarCarta()];
      dealer = [sacarCarta(), sacarCarta()];
      terminado = false;
      actualizarVista();
    }

    function sacarCarta() {
      return mazo.pop();
    }

    function calcularPuntos(mano) {
      let total = mano.reduce((a, b) => a + b, 0);
      let ases = mano.filter(c => c === 11).length;
      while (total > 21 && ases > 0) {
        total -= 10;
        ases--;
      }
      return total;
    }

    function pedirCarta() {
      if (terminado) return;
      jugador.push(sacarCarta());
      actualizarVista();
      const puntos = calcularPuntos(jugador);
      if (puntos > 21) {
        terminado = true;
        mostrarMensaje("¡Te pasaste! Pierdes.");
      }
    }

    function plantarse() {
      if (terminado) return;
      terminado = true;
      while (calcularPuntos(dealer) < 17) {
        dealer.push(sacarCarta());
      }
      actualizarVista();
      decidirGanador();
    }

    function decidirGanador() {
      const puntosJugador = calcularPuntos(jugador);
      const puntosDealer = calcularPuntos(dealer);

      if (puntosDealer > 21 || puntosJugador > puntosDealer) {
        mostrarMensaje("¡Ganaste!");
      } else if (puntosJugador === puntosDealer) {
        mostrarMensaje("Empate.");
      } else {
        mostrarMensaje("Pierdes.");
      }
    }

    function mostrarMensaje(msg) {
      document.getElementById("mensaje").textContent = msg;
    }

    function actualizarVista() {
      document.getElementById("cartas-jugador").innerHTML = jugador.map(c => `<div class="card">${c}</div>`).join("");
      document.getElementById("cartas-dealer").innerHTML = dealer.map(c => `<div class="card">${c}</div>`).join("");
      document.getElementById("puntos-jugador").textContent = "Puntos: " + calcularPuntos(jugador);
      document.getElementById("puntos-dealer").textContent = "Puntos: " + calcularPuntos(dealer);
    }

    function reiniciar() {
      barajar();
      repartirInicial();
      mostrarMensaje("");
    }
    // Inicializar
    reiniciar();
    
  </script>
    <script type="module" src="/src/main.js"></script>
  </body>
</html>
